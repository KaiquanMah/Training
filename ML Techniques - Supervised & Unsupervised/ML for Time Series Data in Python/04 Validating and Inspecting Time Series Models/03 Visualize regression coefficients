Now that you've fit the model, let's visualize its coefficients. This is an important part of machine learning because it gives you an idea for how the different features of a model affect the outcome.

The shifted time series DataFrame (prices_perc_shifted) and the regression model (model) are available in your workspace.

In this exercise, you will create a function that, given a set of coefficients and feature names, visualizes the coefficient values.





def visualize_coefficients(coefs, names, ax):
    # Make a bar plot for the coefficients, including their names on the x-axis
    ax.bar(names, coefs)
    ax.set(xlabel='Coefficient name', ylabel='Coefficient value')
    
    # Set formatting so it looks nice
    plt.setp(ax.get_xticklabels(), rotation=45, horizontalalignment='right')
    return ax
    
    
    
    



prices_perc_shifted
            lag_1_day  lag_2_day  lag_3_day  lag_4_day  lag_5_day  lag_6_day  \
date                                                                           
2010-01-04        NaN        NaN        NaN        NaN        NaN        NaN   
2010-01-05        NaN        NaN        NaN        NaN        NaN        NaN   
2010-01-06   0.001729        NaN        NaN        NaN        NaN        NaN   
2010-01-07  -0.015906   0.001729        NaN        NaN        NaN        NaN   
2010-01-08  -0.001849  -0.015906   0.001729        NaN        NaN        NaN   
2010-01-11   0.006648  -0.001849  -0.015906   0.001729        NaN        NaN   
2010-01-12  -0.008822   0.006648  -0.001849  -0.015906   0.001729        NaN   
2010-01-13  -0.011375  -0.008822   0.006648  -0.001849  -0.015906   0.001729   
2010-01-14   0.014106  -0.011375  -0.008822   0.006648  -0.001849  -0.015906   
2010-01-15  -0.005792   0.014106  -0.011375  -0.008822   0.006648  -0.001849   
2010-01-19  -0.016712  -0.005792   0.014106  -0.011375  -0.008822   0.006648   
2010-01-20   0.044238  -0.016712  -0.005792   0.014106  -0.011375  -0.008822   
2010-01-21  -0.015392   0.044238  -0.016712  -0.005792   0.014106  -0.011375   
2010-01-22  -0.017286  -0.015392   0.044238  -0.016712  -0.005792   0.014106   
2010-01-25   0.000756  -0.017286  -0.015392   0.044238  -0.016712  -0.005792   
2010-01-26   0.026903   0.000756  -0.017286  -0.015392   0.044238  -0.016712   
2010-01-27   0.014133   0.026903   0.000756  -0.017286  -0.015392   0.044238   
2010-01-28   0.009420   0.014133   0.026903   0.000756  -0.017286  -0.015392   
2010-01-29  -0.041322   0.009420   0.014133   0.026903   0.000756  -0.017286   
2010-02-01  -0.036279  -0.041322   0.009420   0.014133   0.026903   0.000756   
2010-02-02   0.013902  -0.036279  -0.041322   0.009420   0.014133   0.026903   
2010-02-03   0.005803   0.013902  -0.036279  -0.041322   0.009420   0.014133   
2010-02-04   0.017206   0.005803   0.013902  -0.036279  -0.041322   0.009420   
2010-02-05  -0.036039   0.017206   0.005803   0.013902  -0.036279  -0.041322   
2010-02-08   0.017756  -0.036039   0.017206   0.005803   0.013902  -0.036279   
2010-02-09  -0.006856   0.017756  -0.036039   0.017206   0.005803   0.013902   
2010-02-10   0.010664  -0.006856   0.017756  -0.036039   0.017206   0.005803   
2010-02-11  -0.005454   0.010664  -0.006856   0.017756  -0.036039   0.017206   
2010-02-12   0.018194  -0.005454   0.010664  -0.006856   0.017756  -0.036039   
2010-02-16   0.008607   0.018194  -0.005454   0.010664  -0.006856   0.017756   
...               ...        ...        ...        ...        ...        ...   
2016-11-17   0.026888   0.013244  -0.025085   0.005937  -0.027868  -0.001621   
2016-11-18  -0.000364   0.026888   0.013244  -0.025085   0.005937  -0.027868   
2016-11-21   0.001000  -0.000364   0.026888   0.013244  -0.025085   0.005937   
2016-11-22   0.015174   0.001000  -0.000364   0.026888   0.013244  -0.025085   
2016-11-23   0.000627   0.015174   0.001000  -0.000364   0.026888   0.013244   
2016-11-25  -0.005098   0.000627   0.015174   0.001000  -0.000364   0.026888   
2016-11-28   0.005035  -0.005098   0.000627   0.015174   0.001000  -0.000364   
2016-11-29  -0.001968   0.005035  -0.005098   0.000627   0.015174   0.001000   
2016-11-30  -0.000986  -0.001968   0.005035  -0.005098   0.000627   0.015174   
2016-12-01  -0.008434  -0.000986  -0.001968   0.005035  -0.005098   0.000627   
2016-12-02  -0.009320  -0.008434  -0.000986  -0.001968   0.005035  -0.005098   
2016-12-05   0.003745  -0.009320  -0.008434  -0.000986  -0.001968   0.005035   
2016-12-06  -0.007188   0.003745  -0.009320  -0.008434  -0.000986  -0.001968   
2016-12-07   0.007699  -0.007188   0.003745  -0.009320  -0.008434  -0.000986   
2016-12-08   0.009823   0.007699  -0.007188   0.003745  -0.009320  -0.008434   
2016-12-09   0.009817   0.009823   0.007699  -0.007188   0.003745  -0.009320   
2016-12-12   0.016322   0.009817   0.009823   0.007699  -0.007188   0.003745   
2016-12-13  -0.005704   0.016322   0.009817   0.009823   0.007699  -0.007188   
2016-12-14   0.016681  -0.005704   0.016322   0.009817   0.009823   0.007699   
2016-12-15   0.000000   0.016681  -0.005704   0.016322   0.009817   0.009823   
2016-12-16   0.005469   0.000000   0.016681  -0.005704   0.016322   0.009817   
2016-12-19   0.001295   0.005469   0.000000   0.016681  -0.005704   0.016322   
2016-12-20   0.005777   0.001295   0.005469   0.000000   0.016681  -0.005704   
2016-12-21   0.002658   0.005777   0.001295   0.005469   0.000000   0.016681   
2016-12-22   0.000941   0.002658   0.005777   0.001295   0.005469   0.000000   
2016-12-23  -0.006578   0.000941   0.002658   0.005777   0.001295   0.005469   
2016-12-27   0.001978  -0.006578   0.000941   0.002658   0.005777   0.001295   
2016-12-28   0.006351   0.001978  -0.006578   0.000941   0.002658   0.005777   
2016-12-29  -0.004264   0.006351   0.001978  -0.006578   0.000941   0.002658   
2016-12-30  -0.000257  -0.004264   0.006351   0.001978  -0.006578   0.000941   

            lag_7_day  lag_8_day  lag_9_day  lag_10_day  
date                                                     
2010-01-04        NaN        NaN        NaN         NaN  
2010-01-05        NaN        NaN        NaN         NaN  
2010-01-06        NaN        NaN        NaN         NaN  
2010-01-07        NaN        NaN        NaN         NaN  
2010-01-08        NaN        NaN        NaN         NaN  
2010-01-11        NaN        NaN        NaN         NaN  
2010-01-12        NaN        NaN        NaN         NaN  
2010-01-13        NaN        NaN        NaN         NaN  
2010-01-14   0.001729        NaN        NaN         NaN  
2010-01-15  -0.015906   0.001729        NaN         NaN  
2010-01-19  -0.001849  -0.015906   0.001729         NaN  
2010-01-20   0.006648  -0.001849  -0.015906    0.001729  
2010-01-21  -0.008822   0.006648  -0.001849   -0.015906  
2010-01-22  -0.011375  -0.008822   0.006648   -0.001849  
2010-01-25   0.014106  -0.011375  -0.008822    0.006648  
2010-01-26  -0.005792   0.014106  -0.011375   -0.008822  
2010-01-27  -0.016712  -0.005792   0.014106   -0.011375  
2010-01-28   0.044238  -0.016712  -0.005792    0.014106  
2010-01-29  -0.015392   0.044238  -0.016712   -0.005792  
2010-02-01  -0.017286  -0.015392   0.044238   -0.016712  
2010-02-02   0.000756  -0.017286  -0.015392    0.044238  
2010-02-03   0.026903   0.000756  -0.017286   -0.015392  
2010-02-04   0.014133   0.026903   0.000756   -0.017286  
2010-02-05   0.009420   0.014133   0.026903    0.000756  
2010-02-08  -0.041322   0.009420   0.014133    0.026903  
2010-02-09  -0.036279  -0.041322   0.009420    0.014133  
2010-02-10   0.013902  -0.036279  -0.041322    0.009420  
2010-02-11   0.005803   0.013902  -0.036279   -0.041322  
2010-02-12   0.017206   0.005803   0.013902   -0.036279  
2010-02-16  -0.036039   0.017206   0.005803    0.013902  
...               ...        ...        ...         ...  
2016-11-17   0.005887   0.014425  -0.009014   -0.015772  
2016-11-18  -0.001621   0.005887   0.014425   -0.009014  
2016-11-21  -0.027868  -0.001621   0.005887    0.014425  
2016-11-22   0.005937  -0.027868  -0.001621    0.005887  
2016-11-23  -0.025085   0.005937  -0.027868   -0.001621  
2016-11-25   0.013244  -0.025085   0.005937   -0.027868  
2016-11-28   0.026888   0.013244  -0.025085    0.005937  
2016-11-29  -0.000364   0.026888   0.013244   -0.025085  
2016-11-30   0.001000  -0.000364   0.026888    0.013244  
2016-12-01   0.015174   0.001000  -0.000364    0.026888  
2016-12-02   0.000627   0.015174   0.001000   -0.000364  
2016-12-05  -0.005098   0.000627   0.015174    0.001000  
2016-12-06   0.005035  -0.005098   0.000627    0.015174  
2016-12-07  -0.001968   0.005035  -0.005098    0.000627  
2016-12-08  -0.000986  -0.001968   0.005035   -0.005098  
2016-12-09  -0.008434  -0.000986  -0.001968    0.005035  
2016-12-12  -0.009320  -0.008434  -0.000986   -0.001968  
2016-12-13   0.003745  -0.009320  -0.008434   -0.000986  
2016-12-14  -0.007188   0.003745  -0.009320   -0.008434  
2016-12-15   0.007699  -0.007188   0.003745   -0.009320  
2016-12-16   0.009823   0.007699  -0.007188    0.003745  
2016-12-19   0.009817   0.009823   0.007699   -0.007188  
2016-12-20   0.016322   0.009817   0.009823    0.007699  
2016-12-21  -0.005704   0.016322   0.009817    0.009823  
2016-12-22   0.016681  -0.005704   0.016322    0.009817  
2016-12-23   0.000000   0.016681  -0.005704    0.016322  
2016-12-27   0.005469   0.000000   0.016681   -0.005704  
2016-12-28   0.001295   0.005469   0.000000    0.016681  
2016-12-29   0.005777   0.001295   0.005469    0.000000  
2016-12-30   0.002658   0.005777   0.001295    0.005469  

[1762 rows x 10 columns]





# Visualize the output data up to "2011-01"
fig, axs = plt.subplots(2, 1, figsize=(10, 5))
y.loc[:'2011-01'].plot(ax=axs[0])

# Run the function to visualize model's coefficients
visualize_coefficients(model.coef_, prices_perc_shifted.columns, ax=axs[1])
plt.show()



When you use time-lagged features on the raw data, you see that the highest coefficient by far is the first one. This means that the N-1th time point is useful in predicting the Nth timepoint, but no other points are useful.

