In this exercise, you'll start with perhaps the simplest classification technique: averaging across dimensions of a dataset and visually inspecting the result.
You'll use the heartbeat data described in the last chapter. Some recordings are normal heartbeat activity, while others are abnormal activity. Let's see if you can spot the difference.
Two DataFrames, normal and abnormal, each with the shape of (n_times_points, n_audio_files) containing the audio for several heartbeats are available in your workspace. Also, the sampling frequency is loaded into a variable called sfreq. A convenience plotting function show_plot_and_make_titles() is also available in your workspace.


normal
                 3         4         6
time                                  
0.000000 -0.000995  0.000281  0.002953
0.000454 -0.003381  0.000381  0.003034
0.000907 -0.000948  0.000063  0.000292
0.001361 -0.000766  0.000026 -0.005916
0.001814  0.000469 -0.000432 -0.005307
0.002268  0.001511  0.000075 -0.003470
0.002721  0.007789 -0.001401 -0.010840
0.003175 -0.000887 -0.002424 -0.010687
0.003628 -0.091828 -0.002455 -0.016578
0.004082 -0.120524 -0.003432 -0.014512
0.004535  0.002223 -0.003624 -0.008936
0.004989  0.264330 -0.002467 -0.004937
0.005442  0.445213 -0.000047 -0.005158
0.005896  0.386544  0.001159 -0.003911
0.006349  0.022272  0.001332  0.000269
0.006803 -0.451281  0.000048 -0.004121
0.007256 -0.672748  0.001751 -0.001480
0.007710 -0.682705  0.002623  0.000852
0.008163 -0.433270  0.003451  0.000985
0.008617 -0.037990  0.005220  0.005785
0.009070  0.339359  0.003985 -0.000447
0.009524  0.603342  0.000934  0.000528
0.009977  0.683132 -0.001616  0.000780
0.010431  0.586438 -0.002338 -0.002808
0.010884  0.357845 -0.002747  0.002628
0.011338  0.095203 -0.002808 -0.000968
0.011791 -0.135961 -0.003379  0.004712
0.012245 -0.282994 -0.003201  0.001077
0.012698 -0.352844 -0.002562  0.002798
0.013152 -0.359543 -0.001380  0.012747
...            ...       ...       ...
3.986395 -0.000640 -0.140288 -0.016039
3.986848 -0.000932 -0.120198 -0.005723
3.987302 -0.000639 -0.090558 -0.012296
3.987755 -0.000034 -0.060420 -0.014551
3.988209 -0.000146 -0.033810 -0.002689
3.988662 -0.000069 -0.008955 -0.000464
3.989116  0.000163  0.009616 -0.001208
3.989569  0.000186  0.023691 -0.004614
3.990023  0.000243  0.030410 -0.010262
3.990476 -0.000003  0.035486 -0.012766
3.990930  0.000051  0.037313 -0.010062
3.991383  0.000002  0.039243 -0.006681
3.991837 -0.000247  0.036395 -0.004757
3.992290 -0.000055  0.033067  0.001142
3.992744 -0.000031  0.028866  0.000804
3.993197  0.000161  0.023901 -0.003547
3.993651  0.000031  0.019220  0.000228
3.994104  0.000093  0.017192 -0.005150
3.994558 -0.000185  0.008376 -0.010026
3.995011 -0.000182 -0.002800 -0.006075
3.995465 -0.000034 -0.007169 -0.001623
3.995918  0.000034 -0.010088  0.001349
3.996372  0.000192 -0.006626 -0.002345
3.996825  0.000552 -0.004099 -0.001517
3.997279  0.000232 -0.002884  0.004005
3.997732 -0.000089 -0.005931  0.002474
3.998186 -0.000112 -0.004839  0.004467
3.998639 -0.000233 -0.000591  0.016809
3.999093 -0.000103 -0.001320  0.008762
3.999546 -0.000367  0.000652  0.004442

[8820 rows x 3 columns]



abnormal


                 0         1         2
time                                  
0.000000 -0.024684 -0.024507  0.008254
0.000454 -0.060429 -0.047736  0.014809
0.000907 -0.070080 -0.039938  0.010475
0.001361 -0.084212 -0.041199  0.010272
0.001814 -0.085111 -0.036050  0.008580
0.002268 -0.078485 -0.034257  0.008634
0.002721 -0.059435 -0.029402  0.007643
0.003175 -0.037479 -0.026873  0.008110
0.003628 -0.018771 -0.024032  0.008904
0.004082 -0.010869 -0.022241  0.009059
0.004535 -0.016087 -0.019478  0.008365
0.004989 -0.031808 -0.016866  0.006832
0.005442 -0.050857 -0.014168  0.005176
0.005896 -0.062391 -0.010903  0.004007
0.006349 -0.060025 -0.008665  0.004036
0.006803 -0.041530 -0.006617  0.004097
0.007256 -0.011355 -0.005031  0.003647
0.007710  0.020567 -0.001985  0.003091
0.008163  0.041392 -0.000065  0.002911
0.008617  0.045733  0.003434  0.002271
0.009070  0.030313  0.006858  0.000611
0.009524  0.000979  0.010682 -0.002487
0.009977 -0.033496  0.014374 -0.004337
0.010431 -0.060456  0.017826 -0.006319
0.010884 -0.070260  0.020823 -0.007023
0.011338 -0.057435  0.022940 -0.005839
0.011791 -0.025834  0.023005 -0.005149
0.012245  0.013587  0.021638 -0.004248
0.012698  0.047002  0.020116 -0.003385
0.013152  0.064795  0.020501 -0.003413
...            ...       ...       ...
3.986395  0.001116  0.414121  0.018422
3.986848  0.000112  0.338438  0.005917
3.987302 -0.000770  0.257928 -0.005191
3.987755 -0.001015  0.177017 -0.015624
3.988209  0.000108  0.100067 -0.026094
3.988662  0.000373  0.030122 -0.036200
3.989116  0.000671 -0.035604 -0.044022
3.989569  0.002584 -0.101296 -0.049278
3.990023  0.003758 -0.166858 -0.049919
3.990476  0.004774 -0.231884 -0.044996
3.990930  0.003989 -0.293492 -0.036035
3.991383  0.002480 -0.348083 -0.023975
3.991837  0.002017 -0.393964 -0.011280
3.992290  0.001665 -0.429694  0.001474
3.992744  0.001525 -0.455580  0.013602
3.993197  0.001873 -0.472728  0.025168
3.993651  0.002727 -0.483542  0.036681
3.994104  0.004039 -0.490843  0.047533
3.994558  0.004886 -0.496263  0.059333
3.995011  0.004955 -0.500568  0.072984
3.995465  0.005545 -0.501343  0.087628
3.995918  0.006911 -0.496709  0.103080
3.996372  0.008975 -0.485694  0.117393
3.996825  0.010534 -0.466190  0.128866
3.997279  0.010939 -0.437779  0.136350
3.997732  0.010513 -0.401539  0.138510
3.998186  0.009675 -0.360107  0.134382
3.998639  0.007957 -0.317170  0.124178
3.999093  0.006445 -0.275164  0.109530
3.999546  0.006529 -0.233864  0.090629

[8820 rows x 3 columns]







fig, axs = plt.subplots(3, 2, figsize=(15, 7), sharex=True, sharey=True)

#The time array can be calculated by dividing the number of time points (the first element of normal.shape) by the sampling frequency (sfreq).
# Calculate the time array
time = np.arange(normal.shape[0]) / sfreq

array([  0.00000000e+00,   4.53514739e-04,   9.07029478e-04, ...,
         3.99863946e+00,   3.99909297e+00,   3.99954649e+00])



#The normal and abnormal DataFrames already have the same first dimension, so you can hstack them directly.
# Stack the normal/abnormal audio so you can loop and plot
stacked_audio = np.hstack([normal, abnormal]).T
#stacked_audio.__len__()
#6



array([[ -9.95218987e-04,  -3.38075217e-03,  -9.47843189e-04, ...,
         -2.32990569e-04,  -1.03341197e-04,  -3.67499451e-04],
       [  2.80759443e-04,   3.80784913e-04,   6.25667381e-05, ...,
         -5.90919633e-04,  -1.31961866e-03,   6.51859853e-04],
       [  2.95301457e-03,   3.03359400e-03,   2.91513745e-04, ...,
          1.68087184e-02,   8.76232889e-03,   4.44242451e-03],
       [ -2.46844683e-02,  -6.04289919e-02,  -7.00800568e-02, ...,
          7.95730669e-03,   6.44497853e-03,   6.52934378e-03],
       [ -2.45074201e-02,  -4.77363952e-02,  -3.99383977e-02, ...,
         -3.17170024e-01,  -2.75164455e-01,  -2.33864069e-01],
       [  8.25388916e-03,   1.48086222e-02,   1.04754260e-02, ...,
          1.24177605e-01,   1.09529600e-01,   9.06286910e-02]], dtype=float32)





# Loop through each audio file / ax object and plot
# .T.ravel() transposes the array, then unravels it into a 1-D vector for looping
for iaudio, ax in zip(stacked_audio, axs.T.ravel()):
    ax.plot(time, iaudio)
show_plot_and_make_titles()

#ValueError: x and y must have same first dimension, but have shapes (6,) and (8820,)
