Here, you will compare ETS forecasts against seasonal naive forecasting for 20 years of cement, which contains quarterly cement production using time series cross-validation for 4 steps ahead. Because this takes a while to run, a shortened version of the cement series will be available in your workspace.

The second argument for tsCV() must return a forecast object, so you need a function to fit a model and return forecasts. Recall:
> args(tsCV)
function (y, forecastfunction, h = 1, ...)

In this exercise you will use an existing forecasting function as well as one that has been created for you. Remember, sometimes simple methods work better than more sophisticated methods!



A function to return ETS forecasts, fets(), has been written for you.
Apply tsCV() for both ETS and seasonal naive methods to the cement data for a forecast horizon of 4. Use the newly created fets and the existing snaive functions as your forecast function argument for e1 and e2, respectively.
Compute the MSE of the resulting 4-step errors and remove missing values. The expressions for calculating MSE have been provided for you, but the second optional arguments have not (you've used them before).
Save the best MSE as bestmse. You can simply copy the entire line of code that generates the best MSE from the previous instruction.




>cement
      Qtr1  Qtr2  Qtr3  Qtr4
1994 1.468 1.755 1.962 1.833
1995 1.626 1.703 1.733 1.545
1996 1.526 1.593 1.706 1.699
1997 1.511 1.785 1.826 1.830
1998 1.719 1.861 1.956 2.067
1999 1.737 1.944 2.005 2.027
2000 1.835 2.070 1.898 1.652
2001 1.554 1.717 1.679 1.836
2002 1.729 1.992 2.030 1.978
2003 1.831 1.892 2.227 2.090
2004 1.963 2.180 2.307 2.157
2005 1.980 2.481 2.340 2.265
2006 2.027 2.278 2.427 2.451
2007 2.140 2.362 2.536 2.562
2008 2.183 2.558 2.612 2.373
2009 1.963 2.160 2.325 2.273
2010 1.904 2.401 2.494 2.296
2011 2.055 2.273 2.499 2.390
2012 2.067 2.223 2.451 2.503
2013 2.049 2.528 2.637 2.565
2014 2.229     









# Function to return ETS forecasts
fets <- function(y, h) {
  forecast(ets(y), h = h)
}


# Apply tsCV() for both methods
e1 <- tsCV(cement, fets, h = 4)
e2 <- tsCV(cement, snaive, h = 4)


# Compute MSE of resulting errors (watch out for missing values)
mean(e1^2, na.rm = TRUE)
[1] 0.0329896


mean(e2^2, na.rm = TRUE)
[1] 0.03046892



















>e1
                  h=1          h=2          h=3          h=4
1994 Q1  0.2870000000  0.494000000  0.365000000  0.158000000
1994 Q2  0.4796500000  0.350650000  0.143650000  0.220650000
1994 Q3 -0.3360002849 -0.750000521 -0.880000758 -1.057000994
1994 Q4 -0.2070000000 -0.130000000 -0.100000000 -0.288000000
1995 Q1  0.0770000000  0.107000000 -0.081000000 -0.100000000
1995 Q2  0.0300000000 -0.158000000 -0.177000000 -0.110000000
1995 Q3 -0.1807390293 -0.199739029 -0.132739029 -0.019739029
1995 Q4 -0.1771274682 -0.110127468  0.002872532 -0.004127468
1996 Q1 -0.0904457171  0.022554283  0.015554283 -0.172445717
1996 Q2  0.0316167864  0.024616786 -0.163383214  0.110616786
1996 Q3  0.0217296142 -0.166270386  0.107729614  0.148729614
1996 Q4 -0.1680733693  0.105926631  0.146926631  0.150926631
1997 Q1  0.1188396777  0.159839678  0.163839678  0.052839678
1997 Q2  0.1513640940  0.155364094  0.044364094  0.186364094
1997 Q3  0.1452619346  0.034261935  0.176261935  0.271261935
1997 Q4  0.0251928937  0.167192894  0.262192894  0.373192894
1998 Q1  0.1657035118  0.260703512  0.371703512  0.041703512
1998 Q2 -0.0008493323  0.212688352  0.033573922  0.081876332
1998 Q3  0.2030236356  0.027332524  0.076220267  0.050344474
1998 Q4 -0.1392664238 -0.083389730 -0.101595838 -0.017008625
1999 Q1  0.0201818291 -0.006716420  0.072046615  0.072190560
1999 Q2 -0.0144073684  0.061984691  0.061023974  0.130351914
1999 Q3  0.0705840127  0.071385996  0.140418516 -0.111016607
1999 Q4  0.0236307977  0.097474343 -0.152244054 -0.356845033
2000 Q1  0.0629787576 -0.189900172 -0.382181959 -0.270766364
2000 Q2 -0.2631940621 -0.448650423 -0.314294464 -0.346539214
2000 Q3 -0.2791797554 -0.193077464 -0.202406317 -0.291853990
2000 Q4  0.0540711056  0.046092803 -0.041364561  0.177497136
2001 Q1 -0.0143976337 -0.092700258  0.123115941  0.179960914
2001 Q2 -0.0975142961  0.125735342  0.180303307  0.274557067
2001 Q3  0.1934660142  0.237764244  0.340508739  0.334375047
2001 Q4  0.1050771496  0.193611967  0.192762926  0.175717432
2002 Q1  0.1454084792  0.124824317  0.114920171  0.138061131
2002 Q2  0.0095029963 -0.003961708  0.041056630 -0.087768646
2002 Q3  0.0096894850  0.043691798 -0.088218162  0.196747868
2002 Q4  0.0149683903 -0.097048513  0.204171405  0.111252664
2003 Q1 -0.1113864205  0.191442400  0.098908745  0.134314347
2003 Q2  0.2684852856  0.178912623  0.229027582  0.267253528
2003 Q3 -0.0085912381  0.068230530  0.097723479  0.149265592
2003 Q4  0.0686112960  0.092493638  0.144989998  0.063752076
2004 Q1  0.0650020867  0.123439594  0.021828389  0.043029364
2004 Q2  0.0824628412 -0.012541346 -0.022152862  0.315557651
2004 Q3 -0.0762331174 -0.085849084  0.252303441  0.049437954
2004 Q4  0.0113592630  0.317508667  0.093398601  0.093081554
2005 Q1  0.3049976418  0.087760152  0.087164826  0.048883638
2005 Q2 -0.1525828107 -0.147945484 -0.138446045 -0.129934710
2005 Q3 -0.0287500611 -0.053128781 -0.036335228  0.054206279
2005 Q4 -0.0321381144 -0.013027010  0.073651403  0.179020287
2006 Q1  0.0124007145  0.101078786  0.204740810  0.105283643
2006 Q2  0.0943372993  0.196913033  0.095941348  0.087227789
2006 Q3  0.1307194882  0.035863027  0.019216725  0.129978148
2006 Q4 -0.0327544920 -0.046830977  0.048039019  0.166764561
2007 Q1 -0.0293679544  0.075017088  0.179749770  0.032142122
2007 Q2  0.0989438275  0.202516129  0.051473114  0.188462328
2007 Q3  0.1474935314 -0.001823417  0.143089560  0.110214651
2007 Q4 -0.0637945684  0.037096921  0.035704022 -0.149073007
2008 Q1  0.1041465250  0.083547161 -0.081874705 -0.243047395
2008 Q2  0.0362439728 -0.148075563 -0.292236823 -0.357416296
2008 Q3 -0.1651676064 -0.311047482 -0.377158604 -0.284110036
2008 Q4 -0.2175267983 -0.285447613 -0.160289072 -0.154850150
2009 Q1 -0.1147732408 -0.035993231 -0.009397401 -0.139692244
2009 Q2  0.0690838380  0.081871301 -0.060962967  0.217197721
2009 Q3  0.0388434238 -0.097386758  0.173120814  0.184628941
2009 Q4 -0.1201751237  0.148169565  0.159281759  0.038837912
2010 Q1  0.2429265549  0.261790176  0.132604533  0.123292539
2010 Q2  0.1146385488 -0.022839748 -0.018631115 -0.069801299
2010 Q3 -0.0805522875 -0.070081729 -0.104558542  0.043945880
2010 Q4 -0.0240802787 -0.052551457  0.091823894  0.063725615
2011 Q1 -0.0348447910  0.109062166  0.074490688  0.009388134
2011 Q2  0.1349865429  0.110526302  0.032702298 -0.061963777
2011 Q3  0.0089382973 -0.038828754 -0.142685696 -0.001976187
2011 Q4 -0.0555828378 -0.148380664 -0.008700085  0.124809825
2012 Q1 -0.1143295248  0.033433058  0.166622699 -0.037718495
2012 Q2  0.1147866585  0.256420566  0.037445060  0.269878898
2012 Q3  0.1634578355 -0.035437991  0.199850980  0.221768096
2012 Q4 -0.1155259876  0.103636511  0.115020187  0.129171614
2013 Q1  0.1884915580  0.202840993  0.207409164  0.144225418
2013 Q2  0.0679508956  0.080704817  0.023725379           NA
2013 Q3  0.0360170510 -0.012063373           NA           NA
2013 Q4 -0.0312195131           NA           NA           NA
2014 Q1            NA           NA           NA           NA





















>e2
           h=1    h=2    h=3    h=4
1994 Q1  0.287     NA     NA     NA
1994 Q2  0.494  0.078     NA     NA
1994 Q3  0.365 -0.129 -0.259     NA
1994 Q4  0.158 -0.052 -0.229 -0.288
1995 Q1 -0.052 -0.229 -0.288 -0.100
1995 Q2 -0.229 -0.288 -0.100 -0.110
1995 Q3 -0.288 -0.100 -0.110 -0.027
1995 Q4 -0.100 -0.110 -0.027  0.154
1996 Q1 -0.110 -0.027  0.154 -0.015
1996 Q2 -0.027  0.154 -0.015  0.192
1996 Q3  0.154 -0.015  0.192  0.120
1996 Q4 -0.015  0.192  0.120  0.131
1997 Q1  0.192  0.120  0.131  0.208
1997 Q2  0.120  0.131  0.208  0.076
1997 Q3  0.131  0.208  0.076  0.130
1997 Q4  0.208  0.076  0.130  0.237
1998 Q1  0.076  0.130  0.237  0.018
1998 Q2  0.130  0.237  0.018  0.083
1998 Q3  0.237  0.018  0.083  0.049
1998 Q4  0.018  0.083  0.049 -0.040
1999 Q1  0.083  0.049 -0.040  0.098
1999 Q2  0.049 -0.040  0.098  0.126
1999 Q3 -0.040  0.098  0.126 -0.107
1999 Q4  0.098  0.126 -0.107 -0.375
2000 Q1  0.126 -0.107 -0.375 -0.281
2000 Q2 -0.107 -0.375 -0.281 -0.353
2000 Q3 -0.375 -0.281 -0.353 -0.219
2000 Q4 -0.281 -0.353 -0.219  0.184
2001 Q1 -0.353 -0.219  0.184  0.175
2001 Q2 -0.219  0.184  0.175  0.275
2001 Q3  0.184  0.175  0.275  0.351
2001 Q4  0.175  0.275  0.351  0.142
2002 Q1  0.275  0.351  0.142  0.102
2002 Q2  0.351  0.142  0.102 -0.100
2002 Q3  0.142  0.102 -0.100  0.197
2002 Q4  0.102 -0.100  0.197  0.112
2003 Q1 -0.100  0.197  0.112  0.132
2003 Q2  0.197  0.112  0.132  0.288
2003 Q3  0.112  0.132  0.288  0.080
2003 Q4  0.132  0.288  0.080  0.067
2004 Q1  0.288  0.080  0.067  0.017
2004 Q2  0.080  0.067  0.017  0.301
2004 Q3  0.067  0.017  0.301  0.033
2004 Q4  0.017  0.301  0.033  0.108
2005 Q1  0.301  0.033  0.108  0.047
2005 Q2  0.033  0.108  0.047 -0.203
2005 Q3  0.108  0.047 -0.203  0.087
2005 Q4  0.047 -0.203  0.087  0.186
2006 Q1 -0.203  0.087  0.186  0.113
2006 Q2  0.087  0.186  0.113  0.084
2006 Q3  0.186  0.113  0.084  0.109
2006 Q4  0.113  0.084  0.109  0.111
2007 Q1  0.084  0.109  0.111  0.043
2007 Q2  0.109  0.111  0.043  0.196
2007 Q3  0.111  0.043  0.196  0.076
2007 Q4  0.043  0.196  0.076 -0.189
2008 Q1  0.196  0.076 -0.189 -0.220
2008 Q2  0.076 -0.189 -0.220 -0.398
2008 Q3 -0.189 -0.220 -0.398 -0.287
2008 Q4 -0.220 -0.398 -0.287 -0.100
2009 Q1 -0.398 -0.287 -0.100 -0.059
2009 Q2 -0.287 -0.100 -0.059  0.241
2009 Q3 -0.100 -0.059  0.241  0.169
2009 Q4 -0.059  0.241  0.169  0.023
2010 Q1  0.241  0.169  0.023  0.151
2010 Q2  0.169  0.023  0.151 -0.128
2010 Q3  0.023  0.151 -0.128  0.005
2010 Q4  0.151 -0.128  0.005  0.094
2011 Q1 -0.128  0.005  0.094  0.012
2011 Q2  0.005  0.094  0.012 -0.050
2011 Q3  0.094  0.012 -0.050 -0.048
2011 Q4  0.012 -0.050 -0.048  0.113
2012 Q1 -0.050 -0.048  0.113 -0.018
2012 Q2 -0.048  0.113 -0.018  0.305
2012 Q3  0.113 -0.018  0.305  0.186
2012 Q4 -0.018  0.305  0.186  0.062
2013 Q1  0.305  0.186  0.062  0.180
2013 Q2  0.186  0.062  0.180     NA
2013 Q3  0.062  0.180     NA     NA
2013 Q4  0.180     NA     NA     NA
2014 Q1     NA     NA     NA     NA



Nice. complex isnt always better

