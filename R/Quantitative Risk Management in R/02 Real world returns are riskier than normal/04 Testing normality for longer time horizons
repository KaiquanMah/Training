Testing normality for longer time horizons
As returns are added together over longer time periods, a central limit effect takes place and returns tend to become more normal.

In this exercise, you will use aggregation functions that you learned in the first chapter to aggregate the data in djx_d, containing the daily log-returns for 29 of the Dow Jones stocks for the period 2008-2011. Then, you'll apply the Jarque-Bera test to the daily, weekly and monthly returns. djx_d is loaded in your workspace.



Calculate weekly and monthly log-returns of djx_d and assign to djx_w and djx_m, respectively.
Fill in apply() to calculate the p-value of the Jarque-Bera test for each of the Dow Jones daily return series in djx_d.
Do the same for the weekly equity returns in djx_w.
Do the same for the monthly equity returns in djx_m.

> head(djx_d)
                  AAPL         AXP           BA         CAT         CSCO
2000-01-03  0.08503386 -0.05565580 -0.030630261  0.03266127  0.008713388
2000-01-04 -0.08807803 -0.03848973 -0.001556443 -0.01293677 -0.057736954
2000-01-05  0.01452806 -0.02572730  0.060441378  0.02316706 -0.003068421
2000-01-06 -0.09051408  0.02016880  0.010211597  0.04963796 -0.016734211
2000-01-07  0.04628094  0.01445411  0.028614251  0.03216477  0.057088979
2000-01-10 -0.01774455  0.01384403 -0.014204766 -0.03337614  0.036515211
                   CVX           DD         DIS            GE           GS
2000-01-03 -0.03524591 -0.013371751  0.02114244 -0.0311755158 -0.064405815
2000-01-04  0.00000000  0.000000000  0.05692598 -0.0408219891 -0.065057654
2000-01-05  0.01777821  0.044200916  0.04066389 -0.0017374975 -0.047959688
2000-01-06  0.04170269  0.051109320 -0.04066389  0.0132807997  0.041899066
2000-01-07  0.01745242  0.001746698 -0.01593636  0.0379906325  0.003792198
2000-01-10 -0.02736054 -0.022948986  0.14202908 -0.0004130439  0.021715565
                     HD          IBM         INTC         JNJ          JPM
2000-01-03 -0.053208991  0.072617040  0.055385122 -0.01145953 -0.063948933
2000-01-04 -0.054173762 -0.034533435 -0.047820801 -0.03729711 -0.022185855
2000-01-05  0.020040741  0.034533435  0.008255201  0.01050061 -0.006192085
2000-01-06 -0.048790158 -0.017391734 -0.060064241  0.03085606  0.014097261
2000-01-07  0.056695350 -0.004395618  0.040440958  0.04165893  0.018205968
2000-01-10 -0.004933417  0.038881788  0.044716839 -0.02558357 -0.017331367
                     KO          MCD          MMM          MRK         MSFT
2000-01-03 -0.032718292 -0.017201340 -0.036414942  0.006490500 -0.001607282
2000-01-04  0.001108019 -0.020717886 -0.040546077 -0.035751685 -0.034363887
2000-01-05  0.008820336  0.015974777  0.028553933  0.038520495  0.010488634
2000-01-06  0.001097079 -0.014365747  0.077358139  0.008260729 -0.034071989
2000-01-07  0.063715812  0.025398184  0.019656654  0.091647169  0.012983516
2000-01-10 -0.032412650  0.004691154 -0.004878066 -0.029625543  0.007264634
                    NKE         PFE           PG          TRV          UNH
2000-01-03 -0.029432332 -0.01749316 -0.021915536 -0.020619278  0.011696869
2000-01-04 -0.056089607 -0.03796657 -0.019429511 -0.013346244 -0.012873553
2000-01-05  0.056089607  0.01616195 -0.019208278 -0.007707155 -0.002357862
2000-01-06 -0.005208424  0.03543678  0.045031298  0.019157644  0.035946231
2000-01-07  0.000000000  0.06550516  0.076918125  0.039074746  0.110924858
2000-01-10  0.016829371 -0.00181321 -0.004840016 -0.018416743 -0.017480839
                    UTX           VZ         WMT          XOM
2000-01-03 -0.039220701 -0.026750565 -0.03402627 -0.028326052
2000-01-04 -0.041864221 -0.032859373 -0.03813619 -0.019339823
2000-01-05 -0.020011164  0.032859373 -0.02061927  0.053081749
2000-01-06  0.046761762 -0.005092555  0.01085358  0.050405572
2000-01-07  0.038830167 -0.007411317  0.07284543 -0.002939037
2000-01-10  0.009718225 -0.005327707 -0.01841673 -0.014079511


> head(djx_w)
                   AAPL         AXP           BA         CAT        CSCO
2000-01-07 -0.032749246 -0.08524993  0.067080522  0.12469429 -0.01173722
2000-01-14  0.009378086  0.04528923 -0.007077177 -0.02612973  0.01581291
2000-01-21  0.102805846 -0.05022134  0.037635115 -0.08566924  0.06903161
2000-01-28 -0.091051991  0.04235340 -0.023530495 -0.08533370 -0.10391543
2000-02-04  0.060841707  0.01994213 -0.014104620 -0.02767840  0.15363481
2000-02-11  0.006920285 -0.05041761 -0.095019531 -0.16156365  0.07789705
                   CVX           DD          DIS           GE           GS
2000-01-07  0.04168742  0.083685183  0.062132056 -0.022463570 -0.131731892
2000-01-14 -0.03736776 -0.060938372  0.075397795 -0.002067479  0.036421706
2000-01-21  0.01780041 -0.063410703 -0.024506377 -0.046598667  0.002101044
2000-01-28 -0.07015293 -0.065329306  0.115235202 -0.072841156  0.015201167
2000-02-04 -0.04966112 -0.007411401  0.036732162  0.054901384 -0.026940109
2000-02-11 -0.05982938 -0.140947744 -0.006579055 -0.056769033  0.005152760
                    HD          IBM        INTC         JNJ         JPM
2000-01-07 -0.07943682  0.050829688 -0.00380376  0.03425895 -0.06002364
2000-01-14 -0.02491409  0.052559019  0.22861636 -0.02957822  0.01534556
2000-01-21 -0.03178126  0.015552406 -0.05100607 -0.04154497 -0.01277155
2000-01-28 -0.07571183 -0.085329282 -0.04103475 -0.06166829  0.05013581
2000-02-04  0.09428823  0.035767217  0.10858168 -0.02850904  0.06392709
2000-02-11 -0.01753527 -0.001112487  0.01068261 -0.05517512  0.01064639
                    KO          MCD         MMM         MRK         MSFT
2000-01-07  0.04202295 -0.010912012  0.04860771  0.10916721 -0.046571008
2000-01-14  0.00513088  0.066324839 -0.03402740 -0.01090159  0.007264634
2000-01-21  0.09092728 -0.036979093 -0.04505266 -0.02302872 -0.078744363
2000-01-28 -0.16087105 -0.110957099 -0.02871649  0.05293129 -0.054468910
2000-02-04 -0.01214814 -0.045225087 -0.03516391 -0.01733432  0.081216418
2000-02-11 -0.01229753 -0.005352354 -0.07125107 -0.14009506 -0.064186673
                    NKE          PFE           PG          TRV          UNH
2000-01-07 -0.034640755  0.061644157  0.061396098  0.016559713  0.143336544
2000-01-14  0.069340616  0.069958591  0.004282669 -0.007326029  0.005083541
2000-01-21 -0.012254406 -0.053785728 -0.127743282 -0.076372999 -0.054178642
2000-01-28 -0.078195092  0.003558718 -0.023400058 -0.048790138 -0.103697754
2000-02-04 -0.004007626  0.015859366 -0.057048478 -0.114662945  0.075465147
2000-02-11 -0.317116323 -0.021202179 -0.010610172 -0.092976432 -0.013304000
                    UTX          VZ          WMT         XOM
2000-01-07 -0.015504156 -0.03925444 -0.009082723  0.05288241
2000-01-14 -0.002933984 -0.04343797 -0.060168517 -0.01407951
2000-01-21 -0.051241781  0.06446922 -0.032499170  0.01481508
2000-01-28 -0.148667417 -0.04142920 -0.124562718 -0.07478693
2000-02-04 -0.016888218  0.01613815  0.021313194  0.02504042
2000-02-11 -0.060168568 -0.04474307 -0.004449395 -0.08494067


> head(djx_m)
                   AAPL          AXP          BA          CAT        CSCO
2000-01-31  0.009077303 -0.007575341  0.07130291 -0.097166902  0.02192816
2000-02-29  0.099681707 -0.205191166 -0.18284136 -0.190900243  0.18829683
2000-03-31  0.169609323  0.104288761  0.02341245  0.117584932  0.15678146
2000-04-28 -0.090489654  0.005491490  0.04839652  0.008107362 -0.10900509
2000-05-31 -0.389968984  0.080302723 -0.01221248 -0.030573523 -0.19689638
2000-06-30  0.220759981 -0.035339405  0.06803240 -0.121466289  0.11006950
                   CVX          DD         DIS           GE           GS
2000-01-31 -0.03524591 -0.11022159  0.21628242 -0.143970872 -0.026211931
2000-02-29 -0.10460738 -0.14906908 -0.06580136 -0.012201130  0.009504484
2000-03-31  0.21322002  0.04713867  0.19329051  0.164756540  0.129129831
2000-04-28 -0.08241199 -0.10969890  0.05597927  0.010387731 -0.119773605
2000-05-31  0.08943051  0.03945829 -0.03350630  0.003966584 -0.237148662
2000-06-30 -0.08608982 -0.11332872 -0.08338155  0.007100607  0.253435644
                    HD         IBM        INTC         JNJ         JPM
2000-01-31 -0.19402615  0.03975538  0.18396534 -0.08021030  0.04353122
2000-02-29  0.01533437 -0.08737766  0.13319939 -0.17481143 -0.01325577
2000-03-31  0.11562299  0.14155870  0.15494051 -0.02460584  0.09073297
2000-04-28 -0.13242458 -0.05983296 -0.03961871  0.16073799 -0.18445765
2000-05-31 -0.14242033 -0.03707363 -0.01665142  0.08506269  0.03491224
2000-06-30  0.01982180  0.02075002  0.06969437  0.12950795 -0.07784856
                     KO         MCD          MMM         MRK        MSFT
2000-01-31 -0.014046719 -0.07565956 -0.044393704  0.15720249 -0.17634373
2000-02-29 -0.166559614 -0.16310931 -0.053375865 -0.24463679 -0.09085015
2000-03-31 -0.031577531  0.16310931  0.004243284  0.01381732  0.17295380
2000-04-28  0.006635693  0.01822753 -0.022120080  0.11217826 -0.42087741
2000-05-31  0.121889808 -0.06093254 -0.003691616  0.07502294 -0.10875133
2000-06-30  0.076590544 -0.08368519 -0.032595499  0.02644783  0.24586054
                   NKE         PFE          PG         TRV         UNH
2000-01-31 -0.08552194  0.10939860 -0.07801577 -0.10969894 -0.00235492
2000-02-29 -0.47000284 -0.11654525 -0.13982378 -0.29948364 -0.03601899
2000-03-31  0.33357075  0.12938859 -0.43725969  0.43112674  0.15434019
2000-04-28  0.09186318  0.14161825  0.05616203  0.04301738  0.11194362
2000-05-31 -0.01303462  0.05680089  0.10703276  0.05129328  0.11161953
2000-06-30 -0.07256877  0.07571183 -0.15854629 -0.08658030  0.13979864
                   UTX          VZ          WMT          XOM
2000-01-31 -0.20527531  0.01251694 -0.233139105  0.028300177
2000-02-29 -0.03469126 -0.23558177 -0.116072162 -0.090097736
2000-03-31  0.21550713  0.22237688  0.148792798  0.035062718
2000-04-28 -0.01595251 -0.01246463 -0.020112405 -0.004014443
2000-05-31 -0.02551791 -0.12641403  0.039828264  0.075317656
2000-06-30 -0.02619326 -0.03978819  0.001091497 -0.059499987





# Calculate weekly and monthly log-returns from djx_d
djx_w <- apply.weekly(djx_d, colSums)
djx_m <- apply.monthly(djx_d, colSums)
#head(djx_d)
#head(djx_w)
#head(djx_m)


# Calculate the p-value for each series in djx_d
apply(djx_d, 2, function(v){jarque.test(v)$p.value})

# Calculate the p-value for each series in djx_w
apply(djx_w, 2, function(v){jarque.test(v)$p.value})

# Calculate the p-value for each series in djx_m
apply(djx_m, 2, function(v){jarque.test(v)$p.value})


> apply(djx_d, 2, function(v){jarque.test(v)$p.value})
AAPL  AXP   BA  CAT CSCO  CVX   DD  DIS   GE   GS   HD  IBM INTC  JNJ  JPM   KO 
   0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0 
 MCD  MMM  MRK MSFT  NKE  PFE   PG  TRV  UNH  UTX   VZ  WMT  XOM 
   0    0    0    0    0    0    0    0    0    0    0    0    0


> apply(djx_w, 2, function(v){jarque.test(v)$p.value})
AAPL  AXP   BA  CAT CSCO  CVX   DD  DIS   GE   GS   HD  IBM INTC  JNJ  JPM   KO 
   0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0 
 MCD  MMM  MRK MSFT  NKE  PFE   PG  TRV  UNH  UTX   VZ  WMT  XOM 
   0    0    0    0    0    0    0    0    0    0    0    0    0


> apply(djx_m, 2, function(v){jarque.test(v)$p.value})
        AAPL          AXP           BA          CAT         CSCO          CVX 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 1.110223e-16 1.883220e-01 
          DD          DIS           GE           GS           HD          IBM 
5.606463e-03 4.879475e-11 6.159517e-13 3.569118e-02 2.912620e-02 0.000000e+00 
        INTC          JNJ          JPM           KO          MCD          MMM 
0.000000e+00 6.779591e-08 1.374971e-06 7.712799e-07 0.000000e+00 1.118650e-01 
         MRK         MSFT          NKE          PFE           PG          TRV 
1.707218e-07 0.000000e+00 0.000000e+00 2.705105e-01 0.000000e+00 0.000000e+00 
         UNH          UTX           VZ          WMT          XOM 
0.000000e+00 0.000000e+00 0.000000e+00 5.047646e-07 8.271246e-03

Although the p-values get larger, all monthly returns other than for Chevron (CVX), 3M (MMM), and Pfizer (PFE) still fail the normality test.
#these 3 tickers have p-values which are not significant when testing for Normality of monthly log-returns - i.e. these 3 tickers have log returns which are Normally distributed
