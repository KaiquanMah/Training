SELECT DISTINCT COUNTRY
FROM HISTORY_DAY
ORDER BY COUNTRY;

SELECT TOP 5 *
FROM HISTORY_DAY;


SELECT DISTINCT POSTAL_CODE
FROM HISTORY_DAY
WHERE POSTAL_CODE LIKE '481%' OR 
      POSTAL_CODE LIKE '482%'
ORDER BY POSTAL_CODE;


SELECT DISTINCT POSTAL_CODE
FROM HISTORY_DAY
WHERE LEFT(POSTAL_CODE,3) IN('481','482')
ORDER BY POSTAL_CODE;

SELECT COUNT(*)
FROM HISTORY_DAY;


SELECT COUNT(*)
FROM HISTORY_DAY H
INNER JOIN MARKETING.MAILERS.DETROIT_ZIPS D
ON H.POSTAL_CODE =D.POSTAL_CODE;



SELECT MIN(DATE_VALID_STD),
       MAX(DATE_VALID_STD)
FROM HISTORY_DAY;

SELECT MIN(DATE_VALID_STD),
       MAX(DATE_VALID_STD)
FROM HISTORY_DAY H
INNER JOIN MARKETING.MAILERS.DETROIT_ZIPS D
ON H.POSTAL_CODE=D.POSTAL_CODE;

SELECT MIN(DATE_VALID_STD),
       MAX(DATE_VALID_STD)
FROM FORECAST_DAY F
INNER JOIN MARKETING.MAILERS.DETROIT_ZIPS D
ON F.POSTAL_CODE=D.POSTAL_CODE;


-- CLOUD COVER
SELECT DATE_VALID_STD,
 AVG(AVG_CLOUD_COVER_TOT_PCT)
FROM FORECAST_DAY F
INNER JOIN MARKETING.MAILERS.DETROIT_ZIPS D
ON F.POSTAL_CODE=D.POSTAL_CODE
GROUP BY DATE_VALID_STD
ORDER BY DATE_VALID_STD;
