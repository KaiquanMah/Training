First value in a window
Suppose you want to figure out the first OrderDate in each territory or the last one. How would you do that? You can use the window functions FIRST_VALUE() and LAST_VALUE(), respectively! Here are the steps:
First, create partitions for each territory
Then, order by OrderDate
Finally, use the FIRST_VALUE() and/or LAST_VALUE() functions as per your requirement


Write a T-SQL query that returns the first OrderDate by creating partitions for each TerritoryName.
SELECT TerritoryName, OrderDate, 
       -- Select the first value in each partition
       FIRST_VALUE(OrderDate) 
       -- Create the partitions and arrange the rows
       OVER(PARTITION BY TerritoryName ORDER BY OrderDate) AS FirstOrder
FROM Orders

TerritoryName	OrderDate	FirstOrder
Australia	2015-02-23 09:00:00	2015-02-23 09:00:00
Australia	2015-02-23 11:00:00	2015-02-23 09:00:00
Australia	2015-02-23 12:00:00	2015-02-23 09:00:00
Australia	2015-04-23 02:00:00	2015-02-23 09:00:00
Australia	2015-04-24 02:00:00	2015-02-23 09:00:00
Australia	2015-05-06 03:00:00	2015-02-23 09:00:00
Australia	2015-05-07 05:00:00	2015-02-23 09:00:00
Australia	2015-06-03 03:00:00	2015-02-23 09:00:00
Australia	2015-06-03 05:00:00	2015-02-23 09:00:00
Australia	2015-06-17 07:00:00	2015-02-23 09:00:00
Australia	2015-06-18 04:00:00	2015-02-23 09:00:00
Australia	2015-07-21 03:00:00	2015-02-23 09:00:00
Australia	2015-07-21 12:00:00	2015-02-23 09:00:00
Canada	2015-01-01 13:00:00	2015-01-01 13:00:00
Canada	2015-01-02 03:00:00	2015-01-01 13:00:00
Canada	2015-01-02 07:00:00	2015-01-01 13:00:00
Canada	2015-01-03 02:00:00	2015-01-01 13:00:00
Canada	2015-01-03 03:00:00	2015-01-01 13:00:00
Canada	2015-02-20 01:00:00	2015-01-01 13:00:00
Canada	2015-02-20 02:00:00	2015-01-01 13:00:00
Canada	2015-02-23 02:00:00	2015-01-01 13:00:00
Canada	2015-02-23 10:00:00	2015-01-01 13:00:00
Canada	2015-04-23 03:00:00	2015-01-01 13:00:00
Canada	2015-04-23 05:00:00	2015-01-01 13:00:00
Canada	2015-04-23 11:00:00	2015-01-01 13:00:00
Canada	2015-04-24 01:00:00	2015-01-01 13:00:00
Canada	2015-04-24 03:00:00	2015-01-01 13:00:00
Canada	2015-04-24 10:00:00	2015-01-01 13:00:00
Canada	2015-05-06 01:00:00	2015-01-01 13:00:00
Canada	2015-05-06 02:00:00	2015-01-01 13:00:00
Canada	2015-05-07 09:00:00	2015-01-01 13:00:00
Canada	2015-05-08 01:00:00	2015-01-01 13:00:00
Canada	2015-05-08 03:00:00	2015-01-01 13:00:00
Canada	2015-05-08 04:00:00	2015-01-01 13:00:00
Canada	2015-05-09 02:00:00	2015-01-01 13:00:00
Canada	2015-06-02 01:00:00	2015-01-01 13:00:00
Canada	2015-06-03 02:00:00	2015-01-01 13:00:00
Canada	2015-06-03 12:00:00	2015-01-01 13:00:00
Canada	2015-06-04 03:00:00	2015-01-01 13:00:00
Canada	2015-06-04 06:00:00	2015-01-01 13:00:00
Canada	2015-06-04 11:00:00	2015-01-01 13:00:00
Canada	2015-06-04 12:00:00	2015-01-01 13:00:00
Canada	2015-06-17 08:00:00	2015-01-01 13:00:00
Canada	2015-06-17 14:00:00	2015-01-01 13:00:00
Canada	2015-06-18 03:00:00	2015-01-01 13:00:00
Canada	2015-06-18 05:00:00	2015-01-01 13:00:00
Canada	2015-07-21 04:00:00	2015-01-01 13:00:00
Canada	2015-07-21 10:00:00	2015-01-01 13:00:00
Canada	2015-07-22 04:00:00	2015-01-01 13:00:00
Canada	2015-07-22 06:00:00	2015-01-01 13:00:00
Central	2015-01-01 05:00:00	2015-01-01 05:00:00
Central	2015-01-01 07:00:00	2015-01-01 05:00:00
Central	2015-01-01 08:00:00	2015-01-01 05:00:00
Central	2015-01-02 09:00:00	2015-01-01 05:00:00
Central	2015-01-02 10:00:00	2015-01-01 05:00:00
Central	2015-01-05 04:00:00	2015-01-01 05:00:00
Central	2015-04-23 08:00:00	2015-01-01 05:00:00
Central	2015-04-23 09:00:00	2015-01-01 05:00:00
Central	2015-04-23 14:00:00	2015-01-01 05:00:00
Central	2015-05-07 04:00:00	2015-01-01 05:00:00
Central	2015-05-07 08:00:00	2015-01-01 05:00:00
Central	2015-05-08 05:00:00	2015-01-01 05:00:00
Central	2015-05-08 07:00:00	2015-01-01 05:00:00
Central	2015-05-09 04:00:00	2015-01-01 05:00:00
Central	2015-06-03 04:00:00	2015-01-01 05:00:00
Central	2015-06-04 04:00:00	2015-01-01 05:00:00
Central	2015-06-04 08:00:00	2015-01-01 05:00:00
Central	2015-06-17 02:00:00	2015-01-01 05:00:00
Central	2015-06-17 03:00:00	2015-01-01 05:00:00
Central	2015-06-18 02:00:00	2015-01-01 05:00:00
Central	2015-07-21 05:00:00	2015-01-01 05:00:00
Central	2015-07-21 11:00:00	2015-01-01 05:00:00
Central	2015-07-22 11:00:00	2015-01-01 05:00:00
Central	2015-07-22 13:00:00	2015-01-01 05:00:00
France	2015-01-01 09:00:00	2015-01-01 09:00:00
France	2015-02-20 04:00:00	2015-01-01 09:00:00
France	2015-04-23 16:00:00	2015-01-01 09:00:00
France	2015-06-04 09:00:00	2015-01-01 09:00:00
France	2015-06-16 01:00:00	2015-01-01 09:00:00
France	2015-06-17 01:00:00	2015-01-01 09:00:00
France	2015-06-17 12:00:00	2015-01-01 09:00:00
France	2015-07-22 07:00:00	2015-01-01 09:00:00
Germany	2015-01-01 01:00:00	2015-01-01 01:00:00
Germany	2015-01-01 10:00:00	2015-01-01 01:00:00
Germany	2015-02-23 06:00:00	2015-01-01 01:00:00
Germany	2015-04-23 06:00:00	2015-01-01 01:00:00
Germany	2015-04-24 13:00:00	2015-01-01 01:00:00
Germany	2015-05-08 09:00:00	2015-01-01 01:00:00
Germany	2015-06-03 07:00:00	2015-01-01 01:00:00
Germany	2015-06-03 11:00:00	2015-01-01 01:00:00
Germany	2015-06-04 07:00:00	2015-01-01 01:00:00
Germany	2015-06-17 06:00:00	2015-01-01 01:00:00
Northeast	2015-01-01 11:00:00	2015-01-01 11:00:00
Northeast	2015-01-02 06:00:00	2015-01-01 11:00:00
Northeast	2015-01-03 01:00:00	2015-01-01 11:00:00
Northeast	2015-01-03 04:00:00	2015-01-01 11:00:00
Northeast	2015-01-05 01:00:00	2015-01-01 11:00:00
Northeast	2015-02-20 03:00:00	2015-01-01 11:00:00
...
