PARTITION BY multiple columns
The PARTITION BY clause can be used to break out window averages by multiple data points (columns). You can even calculate the information you want to use to partition your data! For example, you can calculate average goals scored by season and by country, or by the calendar year (taken from the date column).
In this exercise, you will calculate the average number home and away goals scored Legia Warszawa, and their opponents, partitioned by the month in each season.

Construct two window functions partitioning the average of home and away goals by season and month.
Filter the data set by Legia Warszawa's team ID (8673) so that the window calculation excludes all teams who did not play against them.

SELECT 
	date,
	season,
	home_goal,
	away_goal,
	CASE WHEN hometeam_id = 8673 THEN 'home' 
         ELSE 'away' END AS warsaw_location,
	-- Calculate average goals partitioned by season and month
	AVG(home_goal) OVER(PARTITION BY SEASON, 
         	EXTRACT(MONTH FROM date)) AS season_mo_home,
    AVG(away_goal) OVER(PARTITION BY SEASON, 
         	EXTRACT(MONTH FROM date)) AS season_mo_away
FROM match
WHERE 
	hometeam_id = 8673 
    OR awayteam_id = 8673
ORDER BY (home_goal + away_goal) DESC;




-- https://www.w3schools.com/sql/func_mysql_extract.asp
EXTRACT(part FROM date)
part:
MICROSECOND
SECOND
MINUTE
HOUR
DAY
WEEK
MONTH
QUARTER
YEAR
SECOND_MICROSECOND
MINUTE_MICROSECOND
MINUTE_SECOND
HOUR_MICROSECOND
HOUR_SECOND
HOUR_MINUTE
DAY_MICROSECOND
DAY_SECOND
DAY_MINUTE
DAY_HOUR
YEAR_MONTH









date	season	home_goal	away_goal	warsaw_location	season_mo_home	season_mo_away
2013-09-14	2013/2014	3	5	away	2.2500000000000000	2.5000000000000000
2014-09-13	2014/2015	4	3	home	2.0000000000000000	2.6666666666666667
2013-07-20	2013/2014	5	1	home	2.5000000000000000	2.0000000000000000
2014-08-09	2014/2015	5	0	home	2.0000000000000000	1.00000000000000000000
2012-10-28	2012/2013	3	2	home	1.6666666666666667	2.0000000000000000
2013-06-02	2012/2013	5	0	home	5.0000000000000000	0E-20
2013-12-15	2013/2014	4	1	home	2.2500000000000000	0.25000000000000000000
2013-10-20	2013/2014	4	1	home	2.2500000000000000	0.75000000000000000000
2013-09-25	2013/2014	2	3	away	2.2500000000000000	2.5000000000000000
2013-02-23	2012/2013	3	2	away	3.0000000000000000	2.0000000000000000
2015-03-08	2014/2015	1	3	away	2.0000000000000000	1.5000000000000000
2015-02-15	2014/2015	1	3	home	0.50000000000000000000	1.5000000000000000
2012-11-18	2012/2013	1	3	away	1.00000000000000000000	1.7500000000000000
2011-08-07	2011/2012	1	3	away	1.5000000000000000	2.2500000000000000
2011-08-12	2011/2012	3	1	home	1.5000000000000000	2.2500000000000000
2013-11-23	2013/2014	3	1	home	1.6666666666666667	0.66666666666666666667
2011-08-29	2011/2012	1	3	away	1.5000000000000000	2.2500000000000000
2012-09-29	2012/2013	2	2	away	2.0000000000000000	1.5000000000000000
2012-02-26	2011/2012	0	4	away	1.00000000000000000000	2.0000000000000000
2014-12-14	2014/2015	3	1	away	1.6666666666666667	1.6666666666666667
2013-10-30	2013/2014	3	1	away	2.2500000000000000	0.75000000000000000000
2014-07-26	2014/2015	1	3	away	0.50000000000000000000	2.0000000000000000
2014-09-27	2014/2015	2	2	home	2.0000000000000000	2.6666666666666667
2013-08-03	2013/2014	4	0	home	1.5000000000000000	0.75000000000000000000
2013-04-20	2012/2013	3	1	home	1.5000000000000000	0.75000000000000000000
2014-12-05	2014/2015	0	4	away	1.6666666666666667	1.6666666666666667
2014-04-12	2013/2014	1	3	away	2.0000000000000000	1.5000000000000000
2014-10-05	2014/2015	3	1	away	1.6666666666666667	1.00000000000000000000
2014-03-16	2013/2014	2	2	home	1.00000000000000000000	1.6000000000000000
2012-09-03	2012/2013	3	1	home	2.0000000000000000	1.5000000000000000
2012-09-16	2012/2013	2	2	away	2.0000000000000000	1.5000000000000000
2015-03-15	2014/2015	2	2	home	2.0000000000000000	1.5000000000000000
2012-08-19	2012/2013	4	0	home	2.0000000000000000	1.00000000000000000000
2011-12-05	2011/2012	0	4	away	0E-20	2.0000000000000000
2011-08-21	2011/2012	1	2	home	1.5000000000000000	2.2500000000000000
2011-09-10	2011/2012	1	2	home	1.00000000000000000000	1.6666666666666667
2011-09-18	2011/2012	2	1	away	1.00000000000000000000	1.6666666666666667
2011-11-19	2011/2012	3	0	home	1.7500000000000000	0E-20
2011-11-23	2011/2012	3	0	home	1.7500000000000000	0E-20
2013-03-08	2012/2013	1	2	away	1.2500000000000000	1.00000000000000000000
2013-03-30	2012/2013	1	2	away	1.2500000000000000	1.00000000000000000000
2013-03-15	2012/2013	3	0	home	1.2500000000000000	1.00000000000000000000
2013-04-13	2012/2013	1	2	away	1.5000000000000000	0.75000000000000000000
2013-05-11	2012/2013	0	3	away	0.60000000000000000000	0.80000000000000000000
2012-10-05	2012/2013	2	1	home	1.6666666666666667	2.0000000000000000
2012-10-22	2012/2013	0	3	away	1.6666666666666667	2.0000000000000000
2012-11-10	2012/2013	1	2	home	1.00000000000000000000	1.7500000000000000
2012-11-04	2012/2013	1	2	away	1.00000000000000000000	1.7500000000000000
2012-12-02	2012/2013	3	0	home	2.0000000000000000	0E-20
2014-02-22	2013/2014	0	3	away	0.50000000000000000000	1.5000000000000000
2014-03-02	2013/2014	0	3	home	1.00000000000000000000	1.6000000000000000
2014-03-24	2013/2014	1	2	away	1.00000000000000000000	1.6000000000000000
2014-04-06	2013/2014	3	0	home	2.0000000000000000	1.5000000000000000
2013-07-27	2013/2014	0	3	away	2.5000000000000000	2.0000000000000000
2013-08-10	2013/2014	2	1	away	1.5000000000000000	0.75000000000000000000
2013-09-28	2013/2014	2	1	home	2.2500000000000000	2.5000000000000000
2013-09-22	2013/2014	2	1	home	2.2500000000000000	2.5000000000000000
2015-03-01	2014/2015	3	0	home	2.0000000000000000	1.5000000000000000
2015-03-22	2014/2015	2	1	away	2.0000000000000000	1.5000000000000000
2015-04-29	2014/2015	2	1	home	1.4000000000000000	0.20000000000000000000
2014-08-15	2014/2015	0	3	away	2.0000000000000000	1.00000000000000000000
2014-08-31	2014/2015	2	1	away	2.0000000000000000	1.00000000000000000000
2014-09-21	2014/2015	0	3	away	2.0000000000000000	2.6666666666666667
2014-10-26	2014/2015	1	2	away	1.6666666666666667	1.00000000000000000000
2014-11-02	2014/2015	2	1	home	1.3333333333333333	1.6666666666666667
2014-11-21	2014/2015	0	3	away	1.3333333333333333	1.6666666666666667
2014-11-09	2014/2015	2	1	away	1.3333333333333333	1.6666666666666667
2014-08-24	2014/2015	2	0	home	2.0000000000000000	1.00000000000000000000
2011-10-23	2011/2012	2	0	home	1.00000000000000000000	0.25000000000000000000
2011-10-02	2011/2012	2	0	home	1.00000000000000000000	0.25000000000000000000
2013-10-27	2013/2014	1	1	away	2.2500000000000000	0.75000000000000000000
2011-09-24	2011/2012	0	2	away	1.00000000000000000000	1.6666666666666667
2012-02-19	2011/2012	2	0	away	1.00000000000000000000	2.0000000000000000
2013-11-02	2013/2014	2	0	home	1.6666666666666667	0.66666666666666666667
2013-12-08	2013/2014	2	0	away	2.2500000000000000	0.25000000000000000000
2013-12-04	2013/2014	2	0	home	2.2500000000000000	0.25000000000000000000
2012-04-29	2011/2012	1	1	home	1.00000000000000000000	0.75000000000000000000
2014-12-01	2014/2015	2	0	home	1.6666666666666667	1.6666666666666667
2012-04-14	2011/2012	1	1	away	1.00000000000000000000	0.75000000000000000000
2012-03-24	2011/2012	1	1	home	0.60000000000000000000	0.40000000000000000000
2013-05-24	2012/2013	1	1	away	0.60000000000000000000	0.80000000000000000000
2012-08-26	2012/2013	0	2	away	2.0000000000000000	1.00000000000000000000
2012-09-21	2012/2013	1	1	home	2.0000000000000000	1.5000000000000000
2013-04-06	2012/2013	2	0	home	1.5000000000000000	0.75000000000000000000
2015-04-04	2014/2015	2	0	home	1.4000000000000000	0.20000000000000000000
2015-04-19	2014/2015	2	0	home	1.4000000000000000	0.20000000000000000000
2012-04-07	2011/2012	2	0	home	1.00000000000000000000	0.75000000000000000000
2012-03-03	2011/2012	2	0	home	0.60000000000000000000	0.40000000000000000000
2014-03-09	2013/2014	1	1	away	1.00000000000000000000	1.6000000000000000
2014-08-02	2014/2015	1	1	home	2.0000000000000000	1.00000000000000000000
2014-02-14	2013/2014	1	0	home	0.50000000000000000000	1.5000000000000000
2012-05-06	2011/2012	1	0	home	1.00000000000000000000	0E-20
2013-05-18	2012/2013	1	0	home	0.60000000000000000000	0.80000000000000000000
2011-10-16	2011/2012	0	1	away	1.00000000000000000000	0.25000000000000000000
2013-10-06	2013/2014	1	0	away	2.2500000000000000	0.75000000000000000000
2012-12-07	2012/2013	1	0	away	2.0000000000000000	0E-20
2013-05-05	2012/2013	1	0	home	0.60000000000000000000	0.80000000000000000000
2014-07-19	2014/2015	0	1	home	0.50000000000000000000	2.0000000000000000
2013-11-10	2013/2014	0	1	away	1.6666666666666667	0.66666666666666666667
2014-03-29	2013/2014	1	0	home	1.00000000000000000000	1.6000000000000000
...


Excellent! You successfully partitioned your averages by each month in the season. In the next lesson, we'll expand on the usefulness of information generated with window functions.

