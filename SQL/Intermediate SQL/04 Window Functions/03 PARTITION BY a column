PARTITION BY a column
The PARTITION BY clause allows you to calculate separate "windows" based on columns you want to divide your results. For example, you can create a single column that calculates an overall average of goals scored for each season.
In this exercise, you will be creating a data set of games played by Legia Warszawa (Warsaw League), the top ranked team in Poland, and comparing their individual game performance to the overall average for that season.
Where do you see more outliers? Are they Legia Warszawa's home or away games?

Complete the two window functions that calculate the home and away goal averages. Partition the window functions by season to calculate separate averages for each season.
Filter the query to only include matches played by Legia Warszawa, id = 8673.

SELECT
	date,
	season,
	home_goal,
	away_goal,
	CASE WHEN hometeam_id = 8673 THEN 'home' 
		 ELSE 'away' END AS warsaw_location,
    -- Calculate the average goals scored partitioned by season
    AVG(home_goal) OVER(PARTITION BY season) AS season_homeavg,
    AVG(away_goal) OVER(PARTITION BY season) AS season_awayavg
FROM match
-- Filter the data set for Legia Warszawa matches only
WHERE 
	hometeam_id = 8673 
    OR awayteam_id = 8673
ORDER BY (home_goal + away_goal) DESC;

date	season	home_goal	away_goal	warsaw_location	season_homeavg	season_awayavg
2013-09-14	2013/2014	3	5	away	1.7666666666666667	1.2333333333333333
2014-09-13	2014/2015	4	3	home	1.5666666666666667	1.3333333333333333
2013-07-20	2013/2014	5	1	home	1.7666666666666667	1.2333333333333333
2013-10-20	2013/2014	4	1	home	1.7666666666666667	1.2333333333333333
2013-06-02	2012/2013	5	0	home	1.5666666666666667	1.1333333333333333
2013-02-23	2012/2013	3	2	away	1.5666666666666667	1.1333333333333333
2014-08-09	2014/2015	5	0	home	1.5666666666666667	1.3333333333333333
2012-10-28	2012/2013	3	2	home	1.5666666666666667	1.1333333333333333
2013-09-25	2013/2014	2	3	away	1.7666666666666667	1.2333333333333333
2013-12-15	2013/2014	4	1	home	1.7666666666666667	1.2333333333333333
2014-12-05	2014/2015	0	4	away	1.5666666666666667	1.3333333333333333
2014-10-05	2014/2015	3	1	away	1.5666666666666667	1.3333333333333333
2014-09-27	2014/2015	2	2	home	1.5666666666666667	1.3333333333333333
2014-04-12	2013/2014	1	3	away	1.7666666666666667	1.2333333333333333
2013-08-03	2013/2014	4	0	home	1.7666666666666667	1.2333333333333333
2014-03-16	2013/2014	2	2	home	1.7666666666666667	1.2333333333333333
2013-11-23	2013/2014	3	1	home	1.7666666666666667	1.2333333333333333
2011-08-12	2011/2012	3	1	home	1.0333333333333333	0.93333333333333333333
2013-10-30	2013/2014	3	1	away	1.7666666666666667	1.2333333333333333
2011-08-29	2011/2012	1	3	away	1.0333333333333333	0.93333333333333333333
2015-03-15	2014/2015	2	2	home	1.5666666666666667	1.3333333333333333
2015-03-08	2014/2015	1	3	away	1.5666666666666667	1.3333333333333333
2012-08-19	2012/2013	4	0	home	1.5666666666666667	1.1333333333333333
2015-02-15	2014/2015	1	3	home	1.5666666666666667	1.3333333333333333
2012-11-18	2012/2013	1	3	away	1.5666666666666667	1.1333333333333333
2011-12-05	2011/2012	0	4	away	1.0333333333333333	0.93333333333333333333
2012-09-29	2012/2013	2	2	away	1.5666666666666667	1.1333333333333333
2012-09-16	2012/2013	2	2	away	1.5666666666666667	1.1333333333333333
2014-07-26	2014/2015	1	3	away	1.5666666666666667	1.3333333333333333
2014-12-14	2014/2015	3	1	away	1.5666666666666667	1.3333333333333333
2012-02-26	2011/2012	0	4	away	1.0333333333333333	0.93333333333333333333
2012-09-03	2012/2013	3	1	home	1.5666666666666667	1.1333333333333333
2011-08-07	2011/2012	1	3	away	1.0333333333333333	0.93333333333333333333
2013-04-20	2012/2013	3	1	home	1.5666666666666667	1.1333333333333333
2014-09-21	2014/2015	0	3	away	1.5666666666666667	1.3333333333333333
2011-11-19	2011/2012	3	0	home	1.0333333333333333	0.93333333333333333333
2011-08-21	2011/2012	1	2	home	1.0333333333333333	0.93333333333333333333
2011-09-10	2011/2012	1	2	home	1.0333333333333333	0.93333333333333333333
2011-09-18	2011/2012	2	1	away	1.0333333333333333	0.93333333333333333333
2012-11-04	2012/2013	1	2	away	1.5666666666666667	1.1333333333333333
2012-11-10	2012/2013	1	2	home	1.5666666666666667	1.1333333333333333
2012-12-02	2012/2013	3	0	home	1.5666666666666667	1.1333333333333333
2013-03-08	2012/2013	1	2	away	1.5666666666666667	1.1333333333333333
2013-03-15	2012/2013	3	0	home	1.5666666666666667	1.1333333333333333
2013-03-30	2012/2013	1	2	away	1.5666666666666667	1.1333333333333333
2013-04-13	2012/2013	1	2	away	1.5666666666666667	1.1333333333333333
2013-05-11	2012/2013	0	3	away	1.5666666666666667	1.1333333333333333
2012-10-05	2012/2013	2	1	home	1.5666666666666667	1.1333333333333333
2012-10-22	2012/2013	0	3	away	1.5666666666666667	1.1333333333333333
2013-09-28	2013/2014	2	1	home	1.7666666666666667	1.2333333333333333
2013-07-27	2013/2014	0	3	away	1.7666666666666667	1.2333333333333333
2014-02-22	2013/2014	0	3	away	1.7666666666666667	1.2333333333333333
2014-03-02	2013/2014	0	3	home	1.7666666666666667	1.2333333333333333
2014-03-24	2013/2014	1	2	away	1.7666666666666667	1.2333333333333333
2014-04-06	2013/2014	3	0	home	1.7666666666666667	1.2333333333333333
2013-08-10	2013/2014	2	1	away	1.7666666666666667	1.2333333333333333
2013-09-22	2013/2014	2	1	home	1.7666666666666667	1.2333333333333333
2014-10-26	2014/2015	1	2	away	1.5666666666666667	1.3333333333333333
2014-11-02	2014/2015	2	1	home	1.5666666666666667	1.3333333333333333
2014-11-09	2014/2015	2	1	away	1.5666666666666667	1.3333333333333333
2014-11-21	2014/2015	0	3	away	1.5666666666666667	1.3333333333333333
2015-03-01	2014/2015	3	0	home	1.5666666666666667	1.3333333333333333
2015-03-22	2014/2015	2	1	away	1.5666666666666667	1.3333333333333333
2015-04-29	2014/2015	2	1	home	1.5666666666666667	1.3333333333333333
2014-08-15	2014/2015	0	3	away	1.5666666666666667	1.3333333333333333
2014-08-31	2014/2015	2	1	away	1.5666666666666667	1.3333333333333333
2011-11-23	2011/2012	3	0	home	1.0333333333333333	0.93333333333333333333
2014-03-09	2013/2014	1	1	away	1.7666666666666667	1.2333333333333333
2012-02-19	2011/2012	2	0	away	1.0333333333333333	0.93333333333333333333
2013-11-02	2013/2014	2	0	home	1.7666666666666667	1.2333333333333333
2011-09-24	2011/2012	0	2	away	1.0333333333333333	0.93333333333333333333
2015-04-19	2014/2015	2	0	home	1.5666666666666667	1.3333333333333333
2012-09-21	2012/2013	1	1	home	1.5666666666666667	1.1333333333333333
2014-08-02	2014/2015	1	1	home	1.5666666666666667	1.3333333333333333
2014-08-24	2014/2015	2	0	home	1.5666666666666667	1.3333333333333333
2014-12-01	2014/2015	2	0	home	1.5666666666666667	1.3333333333333333
2012-08-26	2012/2013	0	2	away	1.5666666666666667	1.1333333333333333
2013-12-08	2013/2014	2	0	away	1.7666666666666667	1.2333333333333333
2012-03-03	2011/2012	2	0	home	1.0333333333333333	0.93333333333333333333
2012-04-29	2011/2012	1	1	home	1.0333333333333333	0.93333333333333333333
2013-05-24	2012/2013	1	1	away	1.5666666666666667	1.1333333333333333
2013-04-06	2012/2013	2	0	home	1.5666666666666667	1.1333333333333333
2012-04-14	2011/2012	1	1	away	1.0333333333333333	0.93333333333333333333
2012-04-07	2011/2012	2	0	home	1.0333333333333333	0.93333333333333333333
2015-04-04	2014/2015	2	0	home	1.5666666666666667	1.3333333333333333
2013-12-04	2013/2014	2	0	home	1.7666666666666667	1.2333333333333333
2011-10-23	2011/2012	2	0	home	1.0333333333333333	0.93333333333333333333
2011-10-02	2011/2012	2	0	home	1.0333333333333333	0.93333333333333333333
2013-10-27	2013/2014	1	1	away	1.7666666666666667	1.2333333333333333
2012-03-24	2011/2012	1	1	home	1.0333333333333333	0.93333333333333333333
2013-11-10	2013/2014	0	1	away	1.7666666666666667	1.2333333333333333
2012-05-03	2011/2012	1	0	away	1.0333333333333333	0.93333333333333333333
2013-12-01	2013/2014	1	0	away	1.7666666666666667	1.2333333333333333
2014-02-14	2013/2014	1	0	home	1.7666666666666667	1.2333333333333333
2012-04-21	2011/2012	0	1	home	1.0333333333333333	0.93333333333333333333
2014-03-29	2013/2014	1	0	home	1.7666666666666667	1.2333333333333333
2011-10-16	2011/2012	0	1	away	1.0333333333333333	0.93333333333333333333
2013-08-24	2013/2014	0	1	home	1.7666666666666667	1.2333333333333333
2013-08-31	2013/2014	0	1	away	1.7666666666666667	1.2333333333333333
2015-04-11	2014/2015	1	0	away	1.5666666666666667	1.3333333333333333
...

You've generated an ordered data set with window functions to compare each game's score to averages for that season.
