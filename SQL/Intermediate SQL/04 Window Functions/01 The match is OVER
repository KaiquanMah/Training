The match is OVER
The OVER() clause allows you to pass an aggregate function down a data set, similar to subqueries in SELECT. The OVER() clause offers significant benefits over subqueries in select -- namely, your queries will run faster, and the OVER() clause has a wide range of additional functions and clauses you can include with it that we will cover later on in this chapter.
In this exercise, you will revise some queries from previous chapters using the OVER() clause.

Select the match ID, country name, season, home, and away goals from the match and country tables.
Complete the query that calculates the average number of goals scored overall and then includes the aggregate value in each row using a window function.

SELECT 
	-- Select the id, country name, season, home, and away goals
	m.id, 
  c.name AS country, 
  m.season,
	m.home_goal,
	m.away_goal,
    -- Use a window to include the aggregate average in each row
	AVG(m.home_goal + m.away_goal) OVER() AS overall_avg
FROM match AS m
LEFT JOIN country AS c ON m.country_id = c.id;


id	country	season	home_goal	away_goal	overall_avg
757	Belgium	2011/2012	2	1	2.7321025161642128
758	Belgium	2011/2012	1	1	2.7321025161642128
759	Belgium	2011/2012	3	1	2.7321025161642128
760	Belgium	2011/2012	0	1	2.7321025161642128
761	Belgium	2011/2012	0	0	2.7321025161642128
762	Belgium	2011/2012	1	1	2.7321025161642128
763	Belgium	2011/2012	2	1	2.7321025161642128
764	Belgium	2011/2012	5	0	2.7321025161642128
765	Belgium	2011/2012	2	0	2.7321025161642128
766	Belgium	2011/2012	5	0	2.7321025161642128
767	Belgium	2011/2012	2	4	2.7321025161642128
768	Belgium	2011/2012	1	2	2.7321025161642128
769	Belgium	2011/2012	1	1	2.7321025161642128
770	Belgium	2011/2012	3	1	2.7321025161642128
771	Belgium	2011/2012	1	2	2.7321025161642128
772	Belgium	2011/2012	3	1	2.7321025161642128
773	Belgium	2011/2012	1	0	2.7321025161642128
774	Belgium	2011/2012	2	0	2.7321025161642128
775	Belgium	2011/2012	3	1	2.7321025161642128
776	Belgium	2011/2012	2	2	2.7321025161642128
777	Belgium	2011/2012	2	1	2.7321025161642128
778	Belgium	2011/2012	0	2	2.7321025161642128
779	Belgium	2011/2012	1	2	2.7321025161642128
780	Belgium	2011/2012	2	0	2.7321025161642128
781	Belgium	2011/2012	4	5	2.7321025161642128
782	Belgium	2011/2012	4	0	2.7321025161642128
783	Belgium	2011/2012	1	1	2.7321025161642128
784	Belgium	2011/2012	1	1	2.7321025161642128
785	Belgium	2011/2012	3	2	2.7321025161642128
786	Belgium	2011/2012	1	4	2.7321025161642128
787	Belgium	2011/2012	1	0	2.7321025161642128
788	Belgium	2011/2012	1	1	2.7321025161642128
789	Belgium	2011/2012	2	1	2.7321025161642128
790	Belgium	2011/2012	2	2	2.7321025161642128
791	Belgium	2011/2012	6	2	2.7321025161642128
792	Belgium	2011/2012	2	0	2.7321025161642128
793	Belgium	2011/2012	0	0	2.7321025161642128
794	Belgium	2011/2012	3	1	2.7321025161642128
795	Belgium	2011/2012	2	4	2.7321025161642128
796	Belgium	2011/2012	1	0	2.7321025161642128
797	Belgium	2011/2012	1	0	2.7321025161642128
798	Belgium	2011/2012	3	1	2.7321025161642128
799	Belgium	2011/2012	3	0	2.7321025161642128
800	Belgium	2011/2012	1	3	2.7321025161642128
801	Belgium	2011/2012	1	1	2.7321025161642128
802	Belgium	2011/2012	0	4	2.7321025161642128
803	Belgium	2011/2012	1	1	2.7321025161642128
804	Belgium	2011/2012	2	1	2.7321025161642128
805	Belgium	2011/2012	3	2	2.7321025161642128
806	Belgium	2011/2012	2	0	2.7321025161642128
807	Belgium	2011/2012	0	1	2.7321025161642128
808	Belgium	2011/2012	2	1	2.7321025161642128
809	Belgium	2011/2012	2	3	2.7321025161642128
810	Belgium	2011/2012	0	1	2.7321025161642128
811	Belgium	2011/2012	2	1	2.7321025161642128
812	Belgium	2011/2012	1	1	2.7321025161642128
813	Belgium	2011/2012	0	0	2.7321025161642128
814	Belgium	2011/2012	0	0	2.7321025161642128
815	Belgium	2011/2012	2	0	2.7321025161642128
816	Belgium	2011/2012	2	3	2.7321025161642128
817	Belgium	2011/2012	1	1	2.7321025161642128
818	Belgium	2011/2012	2	2	2.7321025161642128
819	Belgium	2011/2012	0	1	2.7321025161642128
820	Belgium	2011/2012	1	2	2.7321025161642128
821	Belgium	2011/2012	1	0	2.7321025161642128
...



The basic window function with an OVER clause functions just like a subquery in SELECT.

